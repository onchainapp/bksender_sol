(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{109:function(t,r,e){"use strict";var n=e(37),o=e(36).errors,c=e(36).formatters,l=e(10),d=e(190),m=e(191).subscriptions,h=e(1046),f=function(t){if(!t.call||!t.name)throw new Error('When creating a method you need to provide at least the "name" and "call" property.');this.name=t.name,this.call=t.call,this.params=t.params||0,this.inputFormatter=t.inputFormatter,this.outputFormatter=t.outputFormatter,this.transformPayload=t.transformPayload,this.extraFormatters=t.extraFormatters,this.abiCoder=t.abiCoder,this.requestManager=t.requestManager,this.accounts=t.accounts,this.defaultBlock=t.defaultBlock||"latest",this.defaultAccount=t.defaultAccount||null,this.transactionBlockTimeout=t.transactionBlockTimeout||50,this.transactionConfirmationBlocks=t.transactionConfirmationBlocks||24,this.transactionPollingTimeout=t.transactionPollingTimeout||750,this.defaultCommon=t.defaultCommon,this.defaultChain=t.defaultChain,this.defaultHardfork=t.defaultHardfork,this.handleRevert=t.handleRevert};f.prototype.setRequestManager=function(t,r){this.requestManager=t,r&&(this.accounts=r)},f.prototype.createFunction=function(t,r){var e=this.buildCall();return e.call=this.call,this.setRequestManager(t||this.requestManager,r||this.accounts),e},f.prototype.attachToObject=function(t){var r=this.buildCall();r.call=this.call;var e=this.name.split(".");e.length>1?(t[e[0]]=t[e[0]]||{},t[e[0]][e[1]]=r):t[e[0]]=r},f.prototype.getCall=function(t){return n.isFunction(this.call)?this.call(t):this.call},f.prototype.extractCallback=function(t){if(n.isFunction(t[t.length-1]))return t.pop()},f.prototype.validateArgs=function(t){if(t.length!==this.params)throw o.InvalidNumberOfParams(t.length,this.params,this.name)},f.prototype.formatInput=function(t){var r=this;return this.inputFormatter?this.inputFormatter.map((function(e,n){return e?e.call(r,t[n]):t[n]})):t},f.prototype.formatOutput=function(t){var r=this;return n.isArray(t)?t.map((function(t){return r.outputFormatter&&t?r.outputFormatter(t):t})):this.outputFormatter&&t?this.outputFormatter(t):t},f.prototype.toPayload=function(t){var r=this.getCall(t),e=this.extractCallback(t),n=this.formatInput(t);this.validateArgs(n);var o={method:r,params:n,callback:e};return this.transformPayload&&(o=this.transformPayload(o)),o},f.prototype._confirmTransaction=function(t,r,e){var v=this,y=!1,E=!0,w=0,k=0,T=null,x=null,N=n.isObject(e.params[0])&&e.params[0].gas?e.params[0].gas:null,C=n.isObject(e.params[0])&&e.params[0].data&&e.params[0].from&&!e.params[0].to,P=C&&e.params[0].data.length>2,F=[new f({name:"getBlockByNumber",call:"eth_getBlockByNumber",params:2,inputFormatter:[c.inputBlockNumberFormatter,function(t){return!!t}],outputFormatter:c.outputBlockFormatter}),new f({name:"getTransactionReceipt",call:"eth_getTransactionReceipt",params:1,inputFormatter:[null],outputFormatter:c.outputTransactionReceiptFormatter}),new f({name:"getCode",call:"eth_getCode",params:2,inputFormatter:[c.inputAddressFormatter,c.inputDefaultBlockNumberFormatter]}),new f({name:"getTransactionByHash",call:"eth_getTransactionByHash",params:1,inputFormatter:[null],outputFormatter:c.outputTransactionFormatter}),new m({name:"subscribe",type:"eth",subscriptions:{newBlockHeaders:{subscriptionName:"newHeads",params:0,outputFormatter:c.outputBlockFormatter}}})],R={};n.each(F,(function(t){t.attachToObject(R),t.requestManager=v.requestManager}));var B=function(n,m,f,F,sub){if(!f)return sub||(sub={unsubscribe:function(){clearInterval(T)}}),(n?d.resolve(n):R.getTransactionReceipt(r)).catch((function(r){sub.unsubscribe(),y=!0,l._fireError({message:"Failed to check for transaction receipt:",data:r},t.eventEmitter,t.reject)})).then((async function(r){if(!r||!r.blockHash)throw new Error("Receipt missing or blockHash null");if(v.extraFormatters&&v.extraFormatters.receiptFormatter&&(r=v.extraFormatters.receiptFormatter(r)),t.eventEmitter.listeners("confirmation").length>0){var e;if(void 0===n||0!==k){var o=await R.getBlockByNumber("latest"),c=o?o.hash:null;m?x?(e=await R.getBlockByNumber(x.number+1))&&(x=e,t.eventEmitter.emit("confirmation",k,r,c)):(e=await R.getBlockByNumber(r.blockNumber),x=e,t.eventEmitter.emit("confirmation",k,r,c)):t.eventEmitter.emit("confirmation",k,r,c)}(m&&e||!m)&&k++,E=!1,k===v.transactionConfirmationBlocks+1&&(sub.unsubscribe(),t.eventEmitter.removeAllListeners())}return r})).then((async function(r){if(C&&!y){if(!r.contractAddress)return E&&(sub.unsubscribe(),y=!0),void l._fireError(o.NoContractAddressFoundError(r),t.eventEmitter,t.reject,null,r);var code;try{code=await R.getCode(r.contractAddress)}catch(t){}if(!code)return;!0===r.status&&P||code.length>2?(t.eventEmitter.emit("receipt",r),v.extraFormatters&&v.extraFormatters.contractDeployFormatter?t.resolve(v.extraFormatters.contractDeployFormatter(r)):t.resolve(r),E&&t.eventEmitter.removeAllListeners()):l._fireError(o.ContractCodeNotStoredError(r),t.eventEmitter,t.reject,null,r),E&&sub.unsubscribe(),y=!0}return r})).then((async function(r){if(!C&&!y){if(r.outOfGas||N&&N===r.gasUsed||!0!==r.status&&"0x1"!==r.status&&void 0!==r.status)if(JSON.stringify(r,null,2),!1===r.status||"0x0"===r.status)try{var n=null;if(!v.handleRevert||"eth_sendTransaction"!==v.call&&"eth_sendRawTransaction"!==v.call)throw!1;var d=e.params[0];if("eth_sendRawTransaction"===v.call){var m=e.params[0],f=h.parse(m);d=c.inputTransactionFormatter({data:f.data,to:f.to,from:f.from,gas:f.gasLimit.toHexString(),gasPrice:f.gasPrice.toHexString(),value:f.value.toHexString()})}if(!(n=await v.getRevertReason(d,r.blockNumber)))throw!1;l._fireError(o.TransactionRevertInstructionError(n.reason,n.signature,r),t.eventEmitter,t.reject,null,r)}catch(e){l._fireError(o.TransactionRevertedWithoutReasonError(r),t.eventEmitter,t.reject,null,r)}else l._fireError(o.TransactionOutOfGasError(r),t.eventEmitter,t.reject,null,r);else t.eventEmitter.emit("receipt",r),t.resolve(r),E&&t.eventEmitter.removeAllListeners();E&&sub.unsubscribe(),y=!0}})).catch((function(){w++,m?w-1>=v.transactionPollingTimeout&&(sub.unsubscribe(),y=!0,l._fireError(o.TransactionError("Transaction was not mined within "+v.transactionPollingTimeout+" seconds, please make sure your transaction was properly sent. Be aware that it might still be mined!"),t.eventEmitter,t.reject)):w-1>=v.transactionBlockTimeout&&(sub.unsubscribe(),y=!0,l._fireError(o.TransactionError("Transaction was not mined within "+v.transactionBlockTimeout+" blocks, please make sure your transaction was properly sent. Be aware that it might still be mined!"),t.eventEmitter,t.reject))}));sub.unsubscribe(),y=!0,l._fireError({message:"Failed to subscribe to new newBlockHeaders to confirm the transaction receipts.",data:f},t.eventEmitter,t.reject)},O=function(t){const r=()=>{T=setInterval(B.bind(null,t,!0),1e3)};this.requestManager.provider.on?R.subscribe("newBlockHeaders",(function(e,n,sub){e||!n?r():B(t,!1,e,0,sub)})):r()}.bind(this);R.getTransactionReceipt(r).then((function(r){r&&r.blockHash?(t.eventEmitter.listeners("confirmation").length>0&&O(r),B(r,!1)):y||O()})).catch((function(){y||O()}))};var v=function(t,r){return n.isNumber(t)?r.wallet[t]:n.isObject(t)&&t.address&&t.privateKey?t:r.wallet[t.toLowerCase()]};f.prototype.buildCall=function(){var t=this,r="eth_sendTransaction"===t.call||"eth_sendRawTransaction"===t.call,e="eth_call"===t.call,c=function(){var c=d(!r),m=t.toPayload(Array.prototype.slice.call(arguments)),h=function(n,d){var h;if(t.handleRevert&&e&&t.abiCoder&&(!n&&t.isRevertReasonString(d)?h=d.substring(10):n&&n.data&&(h=n.data.substring(10)),h)){var f=t.abiCoder.decodeParameter("string","0x"+h);return void l._fireError(o.RevertInstructionError(f,"Error(String)"),c.eventEmitter,c.reject,m.callback,{reason:f,signature:"Error(String)"})}try{d=t.formatOutput(d)}catch(t){n=t}if(d instanceof Error&&(n=d),n)return n.error&&(n=n.error),l._fireError(n,c.eventEmitter,c.reject,m.callback);m.callback&&m.callback(null,d),r?(c.eventEmitter.emit("transactionHash",d),t._confirmTransaction(c,d,m)):n||c.resolve(d)},y=function(r){var e=n.extend({},m,{method:"eth_sendRawTransaction",params:[r.rawTransaction]});t.requestManager.send(e,h)},E=function(t,r){var e;if(r&&r.accounts&&r.accounts.wallet&&r.accounts.wallet.length)if("eth_sendTransaction"===t.method){var o=t.params[0];if((e=v(n.isObject(o)?o.from:null,r.accounts))&&e.privateKey){var l=n.omit(o,"from");return r.defaultChain&&!l.chain&&(l.chain=r.defaultChain),r.defaultHardfork&&!l.hardfork&&(l.hardfork=r.defaultHardfork),r.defaultCommon&&!l.common&&(l.common=r.defaultCommon),r.accounts.signTransaction(l,e.privateKey).then(y).catch((function(t){n.isFunction(c.eventEmitter.listeners)&&c.eventEmitter.listeners("error").length&&(c.eventEmitter.emit("error",t),c.eventEmitter.removeAllListeners(),c.eventEmitter.catch((function(){}))),c.reject(t)}))}}else if("eth_sign"===t.method){var data=t.params[1];if((e=v(t.params[0],r.accounts))&&e.privateKey){var d=r.accounts.sign(data,e.privateKey);return t.callback&&t.callback(null,d.signature),void c.resolve(d.signature)}}return r.requestManager.send(t,h)};if(r&&n.isObject(m.params[0])&&void 0===m.params[0].gasPrice){var w=new f({name:"getGasPrice",call:"eth_gasPrice",params:0}).createFunction(t.requestManager);w((function(e,n){n&&(m.params[0].gasPrice=n),r&&setTimeout(()=>{c.eventEmitter.emit("sending",m)},0),E(m,t)}))}else r&&setTimeout(()=>{c.eventEmitter.emit("sending",m)},0),E(m,t);return r&&setTimeout(()=>{c.eventEmitter.emit("sent",m)},0),c.eventEmitter};return c.method=t,c.request=this.request.bind(this),c},f.prototype.getRevertReason=function(t,r){var e=this;return new Promise((function(n,o){new f({name:"call",call:"eth_call",params:2,abiCoder:e.abiCoder,handleRevert:!0}).createFunction(e.requestManager)(t,l.numberToHex(r)).then((function(){n(!1)})).catch((function(t){t.reason?n({reason:t.reason,signature:t.signature}):o(t)}))}))},f.prototype.isRevertReasonString=function(data){return n.isString(data)&&(data.length-2)/2%32==4&&"0x08c379a0"===data.substring(0,10)},f.prototype.request=function(){var t=this.toPayload(Array.prototype.slice.call(arguments));return t.format=this.formatOutput.bind(this),t},t.exports=f},190:function(t,r,e){"use strict";var n=e(260),o=function(t){var r,e,o=new Promise((function(){r=arguments[0],e=arguments[1]}));if(t)return{resolve:r,reject:e,eventEmitter:o};var c=new n;return o._events=c._events,o.emit=c.emit,o.on=c.on,o.once=c.once,o.off=c.off,o.listeners=c.listeners,o.addListener=c.addListener,o.removeListener=c.removeListener,o.removeAllListeners=c.removeAllListeners,{resolve:r,reject:e,eventEmitter:o}};o.resolve=function(t){var r=o(!0);return r.resolve(t),r.eventEmitter},t.exports=o},191:function(t,r,e){"use strict";var n=e(607),o=function(t){this.name=t.name,this.type=t.type,this.subscriptions=t.subscriptions||{},this.requestManager=null};o.prototype.setRequestManager=function(t){this.requestManager=t},o.prototype.attachToObject=function(t){var r=this.buildCall(),e=this.name.split(".");e.length>1?(t[e[0]]=t[e[0]]||{},t[e[0]][e[1]]=r):t[e[0]]=r},o.prototype.buildCall=function(){var t=this;return function(){t.subscriptions[arguments[0]]||console.warn("Subscription "+JSON.stringify(arguments[0])+" doesn't exist. Subscribing anyway.");var r=new n({subscription:t.subscriptions[arguments[0]]||{},requestManager:t.requestManager,type:t.type});return r.subscribe.apply(r,arguments)}},t.exports={subscriptions:o,subscription:n}},343:function(t,r,e){"use strict";var n={messageId:0,toPayload:function(t,r){if(!t)throw new Error('JSONRPC method should be specified for params: "'+JSON.stringify(r)+'"!');return n.messageId++,{jsonrpc:"2.0",id:n.messageId,method:t,params:r||[]}},isValidResponse:function(t){return Array.isArray(t)?t.every(r):r(t);function r(t){return!(!t||t.error||"2.0"!==t.jsonrpc||"number"!=typeof t.id&&"string"!=typeof t.id||void 0===t.result)}},toBatchPayload:function(t){return t.map((function(t){return n.toPayload(t.method,t.params)}))}};t.exports=n},36:function(t,r,e){"use strict";var n=e(573),o=e(574);t.exports={errors:n,formatters:o}},570:function(t,r,e){"use strict";const{callbackify:n}=e(90);var o=e(37),c=e(36).errors,l=e(343),d=e(577),m=e(578),h=function t(r,e){this.provider=null,this.providers=t.providers,this.setProvider(r,e),this.subscriptions=new Map};h.givenProvider=m,h.providers={WebsocketProvider:e(579),HttpProvider:e(589),IpcProvider:e(604)},h.prototype.setProvider=function(t,r){var e=this;if(t&&"string"==typeof t&&this.providers)if(/^http(s)?:\/\//i.test(t))t=new this.providers.HttpProvider(t);else if(/^ws(s)?:\/\//i.test(t))t=new this.providers.WebsocketProvider(t);else if(t&&"object"==typeof r&&"function"==typeof r.connect)t=new this.providers.IpcProvider(t,r);else if(t)throw new Error("Can't autodetect provider for \""+t+'"');this.provider&&this.provider.connected&&this.clearSubscriptions(),this.provider=t||null,this.provider&&this.provider.on&&(this.provider.on("data",(function(t,r){(t=t||r).method&&t.params&&t.params.subscription&&e.subscriptions.has(t.params.subscription)&&e.subscriptions.get(t.params.subscription).callback(null,t.params.result)})),this.provider.on("connect",(function(){e.subscriptions.forEach((function(t){t.subscription.resubscribe()}))})),this.provider.on("error",(function(t){e.subscriptions.forEach((function(r){r.callback(t)}))})),this.provider.on("close",(function(t){e._isCleanCloseEvent(t)&&!e._isIpcCloseError(t)||(e.subscriptions.forEach((function(r){r.callback(c.ConnectionCloseError(t)),e.subscriptions.delete(r.subscription.id)})),e.provider&&e.provider.emit&&e.provider.emit("error",c.ConnectionCloseError(t))),e.provider&&e.provider.emit&&e.provider.emit("end",t)})))},h.prototype.send=function(data,t){if(t=t||function(){},!this.provider)return t(c.InvalidProvider());const{method:r,params:e}=data,o=l.toPayload(r,e),d=this._jsonrpcResultCallback(t,o);if(this.provider.request){n(this.provider.request)({method:r,params:e},t)}else if(this.provider.sendAsync)this.provider.sendAsync(o,d);else{if(!this.provider.send)throw new Error("Provider does not have a request or send method to use.");this.provider.send(o,d)}},h.prototype.sendBatch=function(data,t){if(!this.provider)return t(c.InvalidProvider());var r=l.toBatchPayload(data);this.provider[this.provider.sendAsync?"sendAsync":"send"](r,(function(r,e){return r?t(r):o.isArray(e)?void t(null,e):t(c.InvalidResponse(e))}))},h.prototype.addSubscription=function(t,r){if(!this.provider.on)throw new Error("The provider doesn't support subscriptions: "+this.provider.constructor.name);this.subscriptions.set(t.id,{callback:r,subscription:t})},h.prototype.removeSubscription=function(t,r){if(this.subscriptions.has(t)){var e=this.subscriptions.get(t).subscription.options.type;return this.subscriptions.delete(t),void this.send({method:e+"_unsubscribe",params:[t]},r)}"function"==typeof r&&r(null)},h.prototype.clearSubscriptions=function(t){try{var r=this;return this.subscriptions.size>0&&this.subscriptions.forEach((function(e,n){t&&"syncing"===e.name||r.removeSubscription(n)})),this.provider.reset&&this.provider.reset(),!0}catch(t){throw new Error(`Error while clearing subscriptions: ${t}`)}},h.prototype._isCleanCloseEvent=function(t){return"object"==typeof t&&([1e3].includes(t.code)||!0===t.wasClean)},h.prototype._isIpcCloseError=function(t){return"boolean"==typeof t&&t},h.prototype._jsonrpcResultCallback=function(t,r){return function(e,n){return n&&n.id&&r.id!==n.id?t(new Error(`Wrong response id ${n.id} (expected: ${r.id}) in ${JSON.stringify(r)}`)):e?t(e):n&&n.error?t(c.ErrorResponse(n)):l.isValidResponse(n)?void t(null,n.result):t(c.InvalidResponse(n))}},t.exports={Manager:h,BatchManager:d}},573:function(t,r,e){"use strict";t.exports={ErrorResponse:function(t){var r=t&&t.error&&t.error.message?t.error.message:JSON.stringify(t),data=t.error&&t.error.data?t.error.data:null,e=new Error("Returned error: "+r);return e.data=data,e},InvalidNumberOfParams:function(t,r,e){return new Error('Invalid number of parameters for "'+e+'". Got '+t+" expected "+r+"!")},InvalidConnection:function(t,r){return this.ConnectionError("CONNECTION ERROR: Couldn't connect to node "+t+".",r)},InvalidProvider:function(){return new Error("Provider not set or invalid")},InvalidResponse:function(t){var r=t&&t.error&&t.error.message?t.error.message:"Invalid JSON RPC response: "+JSON.stringify(t);return new Error(r)},ConnectionTimeout:function(t){return new Error("CONNECTION TIMEOUT: timeout of "+t+" ms achived")},ConnectionNotOpenError:function(t){return this.ConnectionError("connection not open on send()",t)},ConnectionCloseError:function(t){return"object"==typeof t&&t.code&&t.reason?this.ConnectionError("CONNECTION ERROR: The connection got closed with the close code `"+t.code+"` and the following reason string `"+t.reason+"`",t):new Error("CONNECTION ERROR: The connection closed unexpectedly")},MaxAttemptsReachedOnReconnectingError:function(){return new Error("Maximum number of reconnect attempts reached!")},PendingRequestsOnReconnectingError:function(){return new Error("CONNECTION ERROR: Provider started to reconnect before the response got received!")},ConnectionError:function(t,r){const e=new Error(t);return r&&(e.code=r.code,e.reason=r.reason),e},RevertInstructionError:function(t,r){var e=new Error("Your request got reverted with the following reason string: "+t);return e.reason=t,e.signature=r,e},TransactionRevertInstructionError:function(t,r,e){var n=new Error("Transaction has been reverted by the EVM:\n"+JSON.stringify(e,null,2));return n.reason=t,n.signature=r,n.receipt=e,n},TransactionError:function(t,r){var e=new Error(t);return e.receipt=r,e},NoContractAddressFoundError:function(t){return this.TransactionError("The transaction receipt didn't contain a contract address.",t)},ContractCodeNotStoredError:function(t){return this.TransactionError("The contract code couldn't be stored, please check your gas limit.",t)},TransactionRevertedWithoutReasonError:function(t){return this.TransactionError("Transaction has been reverted by the EVM:\n"+JSON.stringify(t,null,2),t)},TransactionOutOfGasError:function(t){return this.TransactionError("Transaction ran out of gas. Please provide more gas:\n"+JSON.stringify(t,null,2),t)},ResolverMethodMissingError:function(address,t){return new Error("The resolver at "+address+'does not implement requested method: "'+t+'".')},ContractMissingABIError:function(){return new Error("You must provide the json interface of the contract when instantiating a contract object.")},ContractOnceRequiresCallbackError:function(){return new Error("Once requires a callback as the second parameter.")},ContractEventDoesNotExistError:function(t){return new Error('Event "'+t+"\" doesn't exist in this contract.")},ContractReservedEventError:function(t){return new Error('The event "'+t+"\" is a reserved event name, you can't use it.")},ContractMissingDeployDataError:function(){return new Error('No "data" specified in neither the given options, nor the default options.')},ContractNoAddressDefinedError:function(){return new Error("This contract object doesn't have address set yet, please set an address first.")},ContractNoFromAddressDefinedError:function(){return new Error('No "from" address specified in neither the given options, nor the default options.')}}},574:function(t,r,e){"use strict";var n=e(37),o=e(10),c=e(342),l=function(t){return o.toBN(t).toString(10)},d=function(t){if(void 0!==t)return function(t){return"latest"===t||"pending"===t||"earliest"===t}(t)?t:"genesis"===t?"0x0":o.isHexStrict(t)?n.isString(t)?t.toLowerCase():t:o.numberToHex(t)},m=function(t){if(t.to&&(t.to=v(t.to)),t.data&&t.input)throw new Error('You can\'t have "data" and "input" as properties of transactions at the same time, please use either "data" or "input" instead.');if(!t.data&&t.input&&(t.data=t.input,delete t.input),t.data&&!t.data.startsWith("0x")&&(t.data="0x"+t.data),t.data&&!o.isHex(t.data))throw new Error("The data field must be HEX encoded data.");return(t.gas||t.gasLimit)&&(t.gas=t.gas||t.gasLimit),["gasPrice","gas","value","nonce"].filter((function(r){return void 0!==t[r]})).forEach((function(r){t[r]=o.numberToHex(t[r])})),t},h=function(t){return null!==t.blockNumber&&(t.blockNumber=o.hexToNumber(t.blockNumber)),null!==t.transactionIndex&&(t.transactionIndex=o.hexToNumber(t.transactionIndex)),t.nonce=o.hexToNumber(t.nonce),t.gas=o.hexToNumber(t.gas),t.gasPrice=l(t.gasPrice),t.value=l(t.value),t.to&&o.isAddress(t.to)?t.to=o.toChecksumAddress(t.to):t.to=null,t.from&&(t.from=o.toChecksumAddress(t.from)),t},f=function(t){if("string"==typeof t.blockHash&&"string"==typeof t.transactionHash&&"string"==typeof t.logIndex){var r=o.sha3(t.blockHash.replace("0x","")+t.transactionHash.replace("0x","")+t.logIndex.replace("0x",""));t.id="log_"+r.replace("0x","").substr(0,8)}else t.id||(t.id=null);return null!==t.blockNumber&&(t.blockNumber=o.hexToNumber(t.blockNumber)),null!==t.transactionIndex&&(t.transactionIndex=o.hexToNumber(t.transactionIndex)),null!==t.logIndex&&(t.logIndex=o.hexToNumber(t.logIndex)),t.address&&(t.address=o.toChecksumAddress(t.address)),t},v=function(address){var t=new c(address);if(t.isValid()&&t.isDirect())return t.toAddress().toLowerCase();if(o.isAddress(address))return"0x"+address.toLowerCase().replace("0x","");throw new Error('Provided address "'+address+"\" is invalid, the capitalization checksum test failed, or its an indrect IBAN address which can't be converted.")};t.exports={inputDefaultBlockNumberFormatter:function(t){return d(this&&null==t?this.defaultBlock:t)},inputBlockNumberFormatter:d,inputCallFormatter:function(t){var r=(t=m(t)).from||(this?this.defaultAccount:null);return r&&(t.from=v(r)),t},inputTransactionFormatter:function(t){if(t=m(t),!n.isNumber(t.from)&&!n.isObject(t.from)){if(t.from=t.from||(this?this.defaultAccount:null),!t.from&&!n.isNumber(t.from))throw new Error('The send transactions "from" field must be defined!');t.from=v(t.from)}return t},inputAddressFormatter:v,inputPostFormatter:function(t){return t.ttl&&(t.ttl=o.numberToHex(t.ttl)),t.workToProve&&(t.workToProve=o.numberToHex(t.workToProve)),t.priority&&(t.priority=o.numberToHex(t.priority)),n.isArray(t.topics)||(t.topics=t.topics?[t.topics]:[]),t.topics=t.topics.map((function(t){return 0===t.indexOf("0x")?t:o.fromUtf8(t)})),t},inputLogFormatter:function(t){var r=function(t){return null==t?null:0===(t=String(t)).indexOf("0x")?t:o.fromUtf8(t)};return(t.fromBlock||0===t.fromBlock)&&(t.fromBlock=d(t.fromBlock)),(t.toBlock||0===t.toBlock)&&(t.toBlock=d(t.toBlock)),t.topics=t.topics||[],t.topics=t.topics.map((function(t){return n.isArray(t)?t.map(r):r(t)})),r=null,t.address&&(t.address=n.isArray(t.address)?t.address.map((function(t){return v(t)})):v(t.address)),t},inputSignFormatter:function(data){return o.isHexStrict(data)?data:o.utf8ToHex(data)},inputStorageKeysFormatter:function(t){return t.map(o.numberToHex)},outputProofFormatter:function(t){return t.address=o.toChecksumAddress(t.address),t.nonce=o.hexToNumberString(t.nonce),t.balance=o.hexToNumberString(t.balance),t},outputBigNumberFormatter:l,outputTransactionFormatter:h,outputTransactionReceiptFormatter:function(t){if("object"!=typeof t)throw new Error("Received receipt is invalid: "+t);return null!==t.blockNumber&&(t.blockNumber=o.hexToNumber(t.blockNumber)),null!==t.transactionIndex&&(t.transactionIndex=o.hexToNumber(t.transactionIndex)),t.cumulativeGasUsed=o.hexToNumber(t.cumulativeGasUsed),t.gasUsed=o.hexToNumber(t.gasUsed),n.isArray(t.logs)&&(t.logs=t.logs.map(f)),t.contractAddress&&(t.contractAddress=o.toChecksumAddress(t.contractAddress)),void 0!==t.status&&null!==t.status&&(t.status=Boolean(parseInt(t.status))),t},outputBlockFormatter:function(t){return t.gasLimit=o.hexToNumber(t.gasLimit),t.gasUsed=o.hexToNumber(t.gasUsed),t.size=o.hexToNumber(t.size),t.timestamp=o.hexToNumber(t.timestamp),null!==t.number&&(t.number=o.hexToNumber(t.number)),t.difficulty&&(t.difficulty=l(t.difficulty)),t.totalDifficulty&&(t.totalDifficulty=l(t.totalDifficulty)),n.isArray(t.transactions)&&t.transactions.forEach((function(t){if(!n.isString(t))return h(t)})),t.miner&&(t.miner=o.toChecksumAddress(t.miner)),t},outputLogFormatter:f,outputPostFormatter:function(t){return t.expiry=o.hexToNumber(t.expiry),t.sent=o.hexToNumber(t.sent),t.ttl=o.hexToNumber(t.ttl),t.workProved=o.hexToNumber(t.workProved),t.topics||(t.topics=[]),t.topics=t.topics.map((function(t){return o.toUtf8(t)})),t},outputSyncingFormatter:function(t){return t.startingBlock=o.hexToNumber(t.startingBlock),t.currentBlock=o.hexToNumber(t.currentBlock),t.highestBlock=o.hexToNumber(t.highestBlock),t.knownStates&&(t.knownStates=o.hexToNumber(t.knownStates),t.pulledStates=o.hexToNumber(t.pulledStates)),t}}},577:function(t,r,e){"use strict";var n=e(343),o=e(36).errors,c=function(t){this.requestManager=t,this.requests=[]};c.prototype.add=function(t){this.requests.push(t)},c.prototype.execute=function(){var t=this.requests;this.requestManager.sendBatch(t,(function(r,e){e=e||[],t.map((function(t,r){return e[r]||{}})).forEach((function(r,e){if(t[e].callback){if(r&&r.error)return t[e].callback(o.ErrorResponse(r));if(!n.isValidResponse(r))return t[e].callback(o.InvalidResponse(r));try{t[e].callback(null,t[e].format?t[e].format(r.result):r.result)}catch(r){t[e].callback(r)}}}))}))},t.exports=c},578:function(t,r,e){"use strict";var n,o=null;try{n=Function("return this")()}catch(t){n=window}void 0!==n.ethereum?o=n.ethereum:void 0!==n.web3&&n.web3.currentProvider&&(n.web3.currentProvider.sendAsync&&(n.web3.currentProvider.send=n.web3.currentProvider.sendAsync,delete n.web3.currentProvider.sendAsync),!n.web3.currentProvider.on&&n.web3.currentProvider.connection&&"ipcProviderWrapper"===n.web3.currentProvider.connection.constructor.name&&(n.web3.currentProvider.on=function(t,r){if("function"!=typeof r)throw new Error("The second parameter callback must be a function.");switch(t){case"data":this.connection.on("data",(function(data){var t="";data=data.toString();try{t=JSON.parse(data)}catch(t){return r(new Error("Couldn't parse response data"+data))}t.id||-1===t.method.indexOf("_subscription")||r(null,t)}));break;default:this.connection.on(t,r)}}),o=n.web3.currentProvider),t.exports=o},607:function(t,r,e){"use strict";var n=e(37),o=e(36).errors,c=e(260),l=e(36).formatters;function d(t){c.call(this),this.id=null,this.callback=n.identity,this.arguments=null,this.lastBlock=null,this.options={subscription:t.subscription,type:t.type,requestManager:t.requestManager}}d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d.prototype._extractCallback=function(t){if(n.isFunction(t[t.length-1]))return t.pop()},d.prototype._validateArgs=function(t){var r=this.options.subscription;if(r||(r={}),r.params||(r.params=0),t.length!==r.params)throw o.InvalidNumberOfParams(t.length,r.params,r.subscriptionName)},d.prototype._formatInput=function(t){var r=this.options.subscription;return r&&r.inputFormatter?r.inputFormatter.map((function(r,e){return r?r(t[e]):t[e]})):t},d.prototype._formatOutput=function(t){var r=this.options.subscription;return r&&r.outputFormatter&&t?r.outputFormatter(t):t},d.prototype._toPayload=function(t){var r=[];if(this.callback=this._extractCallback(t)||n.identity,this.subscriptionMethod||(this.subscriptionMethod=t.shift(),this.options.subscription.subscriptionName&&(this.subscriptionMethod=this.options.subscription.subscriptionName)),this.arguments||(this.arguments=this._formatInput(t),this._validateArgs(this.arguments),t=[]),r.push(this.subscriptionMethod),r=r.concat(this.arguments),t.length)throw new Error("Only a callback is allowed as parameter on an already instantiated subscription.");return{method:this.options.type+"_subscribe",params:r}},d.prototype.unsubscribe=function(t){this.options.requestManager.removeSubscription(this.id,t),this.id=null,this.lastBlock=null,this.removeAllListeners()},d.prototype.subscribe=function(){var t=this,r=Array.prototype.slice.call(arguments),e=this._toPayload(r);if(!e)return this;if(!this.options.requestManager.provider)return setTimeout((function(){var r=new Error("No provider set.");t.callback(r,null,t),t.emit("error",r)}),0),this;if(!this.options.requestManager.provider.on)return setTimeout((function(){var r=new Error("The current provider doesn't support subscriptions: "+t.options.requestManager.provider.constructor.name);t.callback(r,null,t),t.emit("error",r)}),0),this;if(this.lastBlock&&n.isObject(this.options.params)&&(e.params[1]=this.options.params,e.params[1].fromBlock=l.inputBlockNumberFormatter(this.lastBlock+1)),this.id&&this.unsubscribe(),this.options.params=e.params[1],"logs"===e.params[0]&&n.isObject(e.params[1])&&e.params[1].hasOwnProperty("fromBlock")&&isFinite(e.params[1].fromBlock)){var o=Object.assign({},e.params[1]);this.options.requestManager.send({method:"eth_getLogs",params:[o]},(function(r,e){r?setTimeout((function(){t.callback(r,null,t),t.emit("error",r)}),0):e.forEach((function(r){var output=t._formatOutput(r);t.callback(null,output,t),t.emit("data",output)}))}))}return"object"==typeof e.params[1]&&delete e.params[1].fromBlock,this.options.requestManager.send(e,(function(r,o){!r&&o?(t.id=o,t.method=e.params[0],t.emit("connected",o),t.options.requestManager.addSubscription(t,(function(r,e){r?(t.callback(r,!1,t),t.emit("error",r)):(n.isArray(e)||(e=[e]),e.forEach((function(r){var output=t._formatOutput(r);if(t.lastBlock=n.isObject(output)?output.blockNumber:null,n.isFunction(t.options.subscription.subscriptionHandler))return t.options.subscription.subscriptionHandler.call(t,output);t.emit("data",output),t.callback(null,output,t)})))}))):setTimeout((function(){t.callback(r,!1,t),t.emit("error",r)}),0)})),this},d.prototype.resubscribe=function(){this.options.requestManager.removeSubscription(this.id),this.id=null,this.subscribe(this.callback)},t.exports=d},864:function(t,r,e){"use strict";var n=e(37),o=e(865),c=function t(r){this.givenProvider=t.givenProvider,r&&r._requestManager&&(r=r.currentProvider),"undefined"!=typeof document&&(this.pick=o.pick),this.setProvider(r)};c.givenProvider=null,"undefined"!=typeof ethereum&&ethereum.bzz&&(c.givenProvider=ethereum.bzz),c.prototype.setProvider=function(t){if(n.isObject(t)&&n.isString(t.bzz)&&(t=t.bzz),!n.isString(t)){this.currentProvider=null;var r=new Error("No provider set, please set one using bzz.setProvider().");return this.download=this.upload=this.isAvailable=function(){throw r},!1}return this.currentProvider=t,this.download=o.at(t).download,this.upload=o.at(t).upload,this.isAvailable=o.at(t).isAvailable,!0},t.exports=c}}]);